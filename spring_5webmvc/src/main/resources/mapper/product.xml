<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
   <!-- vs code 확장 프로그램 XML (XML Language Suppport by Red Hat) 설치해야 자동 완성 합니다. -->

<mapper namespace="org.iclass.spring_3mybatis.mapper.ProductMapper">
    <select id="selectAll" resultType="ProductDto">
      SELECT * FROM TBL_PRODUCT ORDER BY pcode
    </select>

    <select id="searchAll" parameterType="ProductSearchDto" resultType="ProductDto">
      SELECT * FROM TBL_PRODUCT
      <!--  조건식이 생기면 where 1=1 키워드 추가됩니다.-->
      <where>
        <!--pcode  필드에 검색어가 있으면-->  
        <if test="pcode !=null and pcode.trim() != ''">
          AND UPPER(PCODE) LIKE '%' || UPPER(#{pcode}) || '%'
        </if>
        <!--pname 필드에 검색어가 있으면-->
        <if test="pname !=null and pname.trim() != ''">
          AND UPPER(PNAME) LIKE '%' || UPPER(#{pname}) || '%'
        </if>
        <!--int 값 조건식-->
        <if test="minPrice > 0">
          AND PRICE &gt;= #{minPrice}
        </if>
        <if test="maxPrice > 0">
          AND PRICE &lt;= #{maxPrice}
        </if>
      </where>
      ORDER BY pcode
    </select>

    <select id = "selectByPk" parameterType="String" resultType="ProductDto">
      SELECT * FROM TBL_PRODUCT WHERE pcode = #{pcode}
    </select>
    <select id="selectByKeyword" parameterType="String" resultType="ProductDto">
      select * from tbl_product where pname like '%' || #{keyword} ||'%'
    </select>
    <insert id="insert" parameterType="ProductDto">
      insert into tbl_product (pcode, category, pname, price)
         values(#{pcode}, #{category}, #{pname}, #{price})
    </insert>
    <update id="update" parameterType="ProductDto">
      update tbl_product
      set pname = #{pname}, price = #{price} where pcode = #{pcode}
    </update>
    <delete id="delete" parameterType="String">
      delete from tbl_product
			where pcode = #{pcode}
    </delete>
    

</mapper>
