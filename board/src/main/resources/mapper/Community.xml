<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="org.iclass.board.mapper.CommunityMapper">


	<select id="selectAll" resultType="CommunityDto">
		SELECT * FROM community ORDER BY idx desc
		<!-- id="selectAll": ì „ì²´ ê¸€ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°. ê¸€ ìµœì‹  ìˆœ(ë‚´ë¦¼ì°¨ìˆœ) ì •ë ¬ -->
	</select>

	<select id="selectByIdx" resultType="CommunityDto" parameterType="long">
		SELECT * FROM community WHERE idx = #{idx} 
		<!-- parameterType="long": ê¸€ ë²ˆí˜¸(idx) ë°›ê³  ê·¸ ë²ˆí˜¸ì— í•´ë‹¹í•˜ëŠ” ê¸€ 1ê°œë§Œ ê°€ì ¸ì˜´ -->
		<!-- ðŸ‘‰ê¸€ ìƒì„¸ë³´ê¸° í•  ë•Œ ì‚¬ìš© -->
	</select>

	<!-- ì¡°íšŒìˆ˜ ì¦ê°€ -->
	<update id="setReadCount" parameterType="long">
		UPDATE community 		
		SET READCOUNT = READCOUNT +1 		<!-- ì¡°íšŒí• ë–„ë§ˆë‹¤ 1ì”© ì¦ê°€-->
		WHERE idx = #{idx}
		<!-- íŠ¹ì • ê¸€ì„ ì—´ëžŒí–ˆì„ ë–„ ì‹¤í–‰ë¨ -->
	</update>

	<!-- ì „ì²´ ê¸€ ê°œìˆ˜ ì¹´ìš´íŠ¸ -->
	<select id="getAllCount" resultType="int">
		SELECT count(*) FROM community 
		<!-- community  í…Œì´ë¸”ì— ê¸€ì´ ëª‡ê°œ ìžˆëŠ”ì§€ ê°œìˆ˜ë§Œ ê°€ì ¸ì˜´ (+ íŽ˜ì´ì§• ì²˜ë¦¬í•  ë–„ í•„ìš”)-->
	</select>

	<!-- ê¸€ëª©ë¡ ê°€ì ¸ì˜¤ê¸°(=> íŽ˜ì´ì§• ì²˜ë¦¬:í•œë²ˆì— ë³´ì—¬ì¤„ ì–‘ì„ ìž˜ë¼ì„œ ê°€ì ¸ì˜¤ëŠ” ê²ƒ) -->
	<select id="selectPageList" parameterType="map" resultType="CommunityDto">
	<!-- parameterType="java.util.Map": startNo(ì‹œìž‘ë²ˆí˜¸), endNo(ë ë²ˆí˜¸) ê°’ì„ Map ìœ¼ë¡œ ì „ë‹¬ -->
		SELECT * FROM 
			(SELECT rownum r ,f.* from		<!-- rownum: Oracle ì—ì„œ í–‰ ë²ˆí˜¸ë¥¼ ë§¤ê¸°ëŠ” ê¸°ëŠ¥-->
				(SELECT * FROM community  ORDER BY idx DESC) f)
		WHERE r BETWEEN #{startNo} AND #{endNo}	
		<!-- BETWEEN #{startNo} AND #{endNo}: íŠ¹ì • ë²”ìœ„ì˜ ê¸€ë§Œ ê°€ì ¸ì˜´ (ex] í•œ íŽ˜ì´ì§€ì— 10ê°œì”© ë³´ì—¬ì£¼ê¸°) -->
	</select>
	
	<!-- ê¸€ ì¶”ê°€(= ìƒˆ ê¸€ ë“±ë¡) -->
	<insert id="insert" parameterType="CommunityDto" useGeneratedKeys="true" keyProperty="idx" keyColumn="idx">
		INSERT INTO community (idx,writer,title,content)
		VALUES (community_idx_seq.nextval,#{writer},#{title},#{content})		<!-- #{writer},#{title},#{content}: ê¸€ì“´ì´, ì œëª©, ë‚´ìš© -->
		<!-- community_idx_seq.nextval: ê¸€ ë²ˆí˜¸ ìžë™ ì¦ê°€ ì‹œí€€ìŠ¤ -->
		<!-- useGeneratedKeys="true": DB ì—ì„œ ìƒì„±ëœ í‚¤(idxê°’)ë¥¼ DTO ì˜ idx ì†ì„±ì— ìžë™ìœ¼ë¡œ ë„£ì–´ì¤Œ -->
	</insert>
	
	<!-- ê¸€ ìˆ˜ì • -->
	<update id="update" parameterType="CommunityDto">
		UPDATE COMMUNITY 
		SET CONTENT = #{content} , title = #{title}
		WHERE idx=#{idx}
		<!-- idx(ê¸€ ë²ˆí˜¸)ì— í•´ë‹¹í•˜ëŠ” ê²Œì‹œê¸€ì˜ ë‚´ìš©, ì œëª©ì„ ìˆ˜ì • -->
	</update>
	
	<!-- ê¸€ ì‚­ì œ -->
	<delete id="delete" parameterType="long">
		DELETE FROM COMMUNITY WHERE idx=#{idx}
		<!-- idx(ê¸€ ë²ˆí˜¸)ì— í•´ë‹¹í•˜ëŠ” ê²Œì‹œê¸€ ì‚­ì œ -->
	</delete>
	
</mapper>